{"version":3,"sources":["../node_modules/peerjs/dist sync","pages/Home/index.js","context/CreateRoomContext.js","utils/index.js","context/RoomContext.js","components/Form/index.js","components/Loading/index.js","components/RadioList/index.js","components/CheckboxList/index.js","pages/CreateRoom/index.js","pages/JoinRoom/index.js","context/SettingsContext.js","components/Video/index.js","components/Video/VideoList.js","pages/Room/Owner/index.js","components/Settings/index.js","components/Toolbar/index.js","pages/Room/Participant/index.js","components/CopyLink/index.js","pages/Room/index.js","pages/CallEnded/index.js","App.js","index.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","Home","className","src","process","alt","to","CreateRoomContext","React","createContext","CreateRoomProvider","children","useState","roomId","setRoomId","type","controls","mic","cam","screen","roomSettings","setRoomSettings","Provider","value","updateType","target","updateControls","checked","a","constraints","video","audio","navigator","mediaDevices","getUserMedia","getDisplayMedia","utils","endMediaStream","stream","getTracks","forEach","track","stop","getScreen","replaceAudio","newStream","oldStream","call","newAudioTrack","getAudioTracks","peerConnection","getSenders","replaceTrack","removeTrack","addTrack","replaceVideo","newVideoTrack","getVideoTracks","toggleAudio","enabled","toggleVideo","isMobile","test","userAgent","RoomContext","RoomProvider","peer","setPeer","roomType","setRoomType","localStream","setLocalStream","screenStream","setScreenStream","calls","setCalls","msg","setMsg","history","useHistory","handleMic","length","handleCam","handleScreenShare","then","addEventListener","err","console","log","handleCallEnd","conns","connections","conn","close","push","Form","title","onSubmit","submitText","Loading","RadioList","name","list","updateValue","map","el","i","prop","onChange","text","CheckboxList","values","updateValues","CreateRoom","useContext","isLoading","setIsLoading","preventDefault","p","Peer","debug","on","htmlFor","placeholder","JoinRoom","document","getElementById","SettingsContext","SettingsProvider","isVisible","setIsVisible","micOpen","setMicOpen","camOpen","setCamOpen","handleOpen","Video","ref","srcObject","props","refVideo","useRef","useEffect","current","VideoList","cols","rows","Math","floor","ceil","container","querySelector","width","clientWidth","height","clientHeight","videoList","style","setProperty","videos","autoPlay","Owner","roomControls","localStreamRef","callsRef","endConnection","newCalls","filter","send","_call","remote","some","oniceconnectionstatechange","iceConnectionState","newConnection","Settings","devices","setDevices","mirrorCam","setMirrorCam","handleChange","deviceId","getSettings","enumerateDevices","device","kind","label","transform","replace","onClick","Toolbar","Participant","setControls","useParams","msgRef","connect","data","answer","CopyLink","readOnly","window","location","origin","copyText","select","setSelectionRange","execCommand","Room","useLocation","isPeerOpen","setIsPeerOpen","setRoomControls","state","muted","CallEnded","App","basename","path","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.6ceb15cf.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 39;","import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nfunction Home() {\r\n  return (\r\n    <header className=\"App-header\">\r\n      <img\r\n        src={process.env.PUBLIC_URL + \"/logo512.png\"}\r\n        className=\"App-logo\"\r\n        alt=\"WeCall Logo\"\r\n      />\r\n      <h3 className=\"flow-text\">O que deseja fazer?</h3>\r\n      <Link to=\"/create\" className=\"blue waves-effect waves-light btn-large\">\r\n        Criar sala\r\n      </Link>\r\n      <Link to=\"/join\" className=\"blue waves-effect waves-light btn-large\">\r\n        Entrar em sala\r\n      </Link>\r\n    </header>\r\n  );\r\n}\r\n\r\nexport default Home;\r\n","import React, { useState } from \"react\";\r\n\r\nexport const CreateRoomContext = React.createContext();\r\n\r\nexport function CreateRoomProvider({ children }) {\r\n  const [roomId, setRoomId] = useState(\"\");\r\n  const [roomSettings, setRoomSettings] = useState({\r\n    type: \"semi-group\",\r\n    controls: { mic: true, cam: true, screen: true },\r\n  });\r\n\r\n  function updateType(e) {\r\n    setRoomSettings({\r\n      ...roomSettings,\r\n      type: e.target.value,\r\n    });\r\n  }\r\n\r\n  function updateControls(e) {\r\n    setRoomSettings({\r\n      ...roomSettings,\r\n      controls: {\r\n        ...roomSettings.controls,\r\n        [e.target.value]: e.target.checked,\r\n      },\r\n    });\r\n  }\r\n\r\n  return (\r\n    <CreateRoomContext.Provider\r\n      value={{\r\n        roomId,\r\n        setRoomId,\r\n        roomSettings,\r\n        updateType,\r\n        updateControls,\r\n      }}\r\n    >\r\n      {children}\r\n    </CreateRoomContext.Provider>\r\n  );\r\n}\r\n","async function getUserMedia(constraints = { video: true, audio: true }) {\r\n  return navigator.mediaDevices.getUserMedia(constraints);\r\n}\r\n\r\nasync function getScreen(constraints = { video: true }) {\r\n  return navigator.mediaDevices.getDisplayMedia(constraints);\r\n}\r\n\r\nfunction endMediaStream(stream) {\r\n  const tracks = stream.getTracks();\r\n  tracks.forEach(function (track) {\r\n    track.stop();\r\n  });\r\n}\r\n\r\n// Replace the video being sent on the call\r\nfunction replaceAudio(newStream, oldStream, call) {\r\n  const newAudioTrack = newStream.getAudioTracks()[0];\r\n  if (call) {\r\n    call.peerConnection.getSenders()[0].replaceTrack(newAudioTrack);\r\n  } else {\r\n    oldStream.removeTrack(oldStream.getAudioTracks()[0]);\r\n    oldStream.addTrack(newAudioTrack);\r\n  }\r\n}\r\n\r\n// Replace the audio being sent on the call\r\nfunction replaceVideo(newStream, oldStream, call) {\r\n  const newVideoTrack = newStream.getVideoTracks()[0];\r\n  if (call) {\r\n    call.peerConnection.getSenders()[1].replaceTrack(newVideoTrack);\r\n  } else {\r\n    oldStream.removeTrack(oldStream.getVideoTracks()[0]);\r\n    oldStream.addTrack(newVideoTrack);\r\n  }\r\n}\r\n\r\nfunction toggleAudio(stream, call) {\r\n  if (call) {\r\n    call.peerConnection.getSenders()[0].track.enabled =\r\n      !call.peerConnection.getSenders()[0].track.enabled;\r\n  } else {\r\n    stream.getAudioTracks()[0].enabled = !stream.getAudioTracks()[0].enabled;\r\n  }\r\n}\r\n\r\nfunction toggleVideo(stream, call) {\r\n  if (call) {\r\n    call.peerConnection.getSenders()[1].track.enabled =\r\n      !call.peerConnection.getSenders()[1].track.enabled;\r\n  } else {\r\n    stream.getVideoTracks()[0].enabled = !stream.getVideoTracks()[0].enabled;\r\n  }\r\n}\r\n\r\nfunction isMobile() {\r\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\r\n    navigator.userAgent\r\n  );\r\n}\r\n\r\nconst utils = {\r\n  endMediaStream,\r\n  getScreen,\r\n  getUserMedia,\r\n  replaceAudio,\r\n  replaceVideo,\r\n  toggleAudio,\r\n  toggleVideo,\r\n  isMobile,\r\n};\r\n\r\nexport default utils;\r\n","import React, { useState } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport utils from \"../utils\";\r\n\r\nexport const RoomContext = React.createContext();\r\n\r\nexport function RoomProvider({ children }) {\r\n  const [peer, setPeer] = useState(null);\r\n  const [roomType, setRoomType] = useState(\"\");\r\n  const [localStream, setLocalStream] = useState(null);\r\n  const [screenStream, setScreenStream] = useState(null);\r\n  const [calls, setCalls] = useState([]);\r\n  const [msg, setMsg] = useState(\"\");\r\n  const history = useHistory();\r\n\r\n  function handleMic() {\r\n    if (calls.length > 0) {\r\n      // Since the audio sender is the same for all the calls, we just toggle it once\r\n      utils.toggleAudio(null, calls[0]);\r\n    } else {\r\n      utils.toggleAudio(localStream);\r\n    }\r\n  }\r\n\r\n  function handleCam() {\r\n    if (calls.length > 0) {\r\n      // Since the video sender is the same for all the calls, we just toggle it once\r\n      utils.toggleVideo(null, calls[0]);\r\n    } else {\r\n      utils.toggleVideo(localStream);\r\n    }\r\n  }\r\n\r\n  function handleScreenShare() {\r\n    if (!screenStream) {\r\n      utils.getScreen().then(\r\n        (stream) => {\r\n          calls.forEach((call) => utils.replaceVideo(stream, null, call));\r\n\r\n          // Must do this here because the user can stop the sharing through browser dialog\r\n          const screenStreamTrack = stream.getVideoTracks()[0];\r\n          screenStreamTrack.addEventListener(\"ended\", () => {\r\n            utils.replaceVideo(localStream, null, calls[0]);\r\n            setScreenStream(null);\r\n          });\r\n\r\n          setScreenStream(stream);\r\n        },\r\n        (err) => {\r\n          console.log(err);\r\n        }\r\n      );\r\n    } else {\r\n      utils.replaceVideo(localStream, calls[0]);\r\n      utils.endMediaStream(screenStream);\r\n      setScreenStream(null);\r\n    }\r\n  }\r\n\r\n  function handleCallEnd() {\r\n    // manually close the peer connections\r\n    console.log(peer.connections);\r\n    for (let conns in peer.connections) {\r\n      peer.connections[conns].forEach((conn) => {\r\n        conn.close();\r\n      });\r\n    }\r\n\r\n    utils.endMediaStream(localStream);\r\n    setLocalStream(null);\r\n    setScreenStream(null);\r\n\r\n    history.push(\"/call-end\");\r\n  }\r\n\r\n  return (\r\n    <RoomContext.Provider\r\n      value={{\r\n        peer,\r\n        setPeer,\r\n        roomType,\r\n        setRoomType,\r\n        localStream,\r\n        setLocalStream,\r\n        screenStream,\r\n        setScreenStream,\r\n        calls,\r\n        setCalls,\r\n        msg,\r\n        setMsg,\r\n        handleMic,\r\n        handleCam,\r\n        handleScreenShare,\r\n        handleCallEnd,\r\n      }}\r\n    >\r\n      {children}\r\n    </RoomContext.Provider>\r\n  );\r\n}\r\n","import React from \"react\";\r\n\r\nfunction Form({ title, onSubmit, submitText, children }) {\r\n  return (\r\n    <section className=\"row\">\r\n      <div className=\"col s12 m8 offset-m2\">\r\n        <div className=\"card grey darken-2\">\r\n          <div className=\"card-content\">\r\n            <span className=\"card-title\">{title}</span>\r\n\r\n            <form className=\"row\" onSubmit={onSubmit}>\r\n              {children}\r\n              <div className=\"input-field col s12\">\r\n                <button type=\"submit\" className=\"btn blue\">\r\n                  {submitText}\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n  );\r\n}\r\n\r\nexport default Form;\r\n","import React from \"react\";\r\nimport \"./styles.css\";\r\n\r\nfunction Loading() {\r\n  return <div className=\"loader\"></div>;\r\n}\r\n\r\nexport default Loading;\r\n","import React from \"react\";\r\n\r\nfunction RadioList({ name, list, value, updateValue }) {\r\n  return list.map((el, i) => {\r\n    return (\r\n      <p key={i}>\r\n        <label>\r\n          <input\r\n            type=\"radio\"\r\n            className=\"with-gap\"\r\n            name={name}\r\n            value={el.prop}\r\n            checked={value === el.prop}\r\n            onChange={updateValue}\r\n          />\r\n          <span className=\"white-text\">{el.text}</span>\r\n        </label>\r\n      </p>\r\n    );\r\n  });\r\n}\r\n\r\nexport default RadioList;\r\n","import React from \"react\";\r\n\r\nfunction CheckboxList({ list, values, updateValues }) {\r\n  return list.map((el, i) => {\r\n    return (\r\n      <p key={i}>\r\n        <label>\r\n          <input\r\n            type=\"checkbox\"\r\n            className=\"filled-in\"\r\n            value={el.prop}\r\n            checked={values[el.prop]}\r\n            onChange={updateValues}\r\n          />\r\n          <span className=\"white-text\">{el.text}</span>\r\n        </label>\r\n      </p>\r\n    );\r\n  });\r\n}\r\n\r\nexport default CheckboxList;\r\n","import Peer from \"peerjs\";\r\nimport React, { useContext, useState } from \"react\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { CreateRoomContext } from \"../../context/CreateRoomContext\";\r\nimport { RoomContext } from \"../../context/RoomContext\";\r\nimport Form from \"../../components/Form\";\r\nimport Loading from \"../../components/Loading\";\r\nimport RadioList from \"../../components/RadioList\";\r\nimport CheckboxList from \"../../components/CheckboxList\";\r\n\r\nfunction CreateRoom() {\r\n  const { roomId, setRoomId, roomSettings, updateType, updateControls } =\r\n    useContext(CreateRoomContext);\r\n  const { setPeer, setRoomType } = useContext(RoomContext);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const history = useHistory();\r\n\r\n  const typeList = [\r\n    {\r\n      prop: \"semi-group\",\r\n      text: \"Semi-grupo (os participantes só podem se comunicar com o anfitrião)\",\r\n    },\r\n    { prop: \"group\", text: \"Grupo (todos podem se comunicar entre si)\" },\r\n  ];\r\n\r\n  const controlsList = [\r\n    { prop: \"mic\", text: \"Microfone\" },\r\n    { prop: \"cam\", text: \"Câmera\" },\r\n    { prop: \"screen\", text: \"Compartilhar tela\" },\r\n  ];\r\n\r\n  function create(e) {\r\n    e.preventDefault();\r\n    const p = new Peer(roomId, { debug: 3 });\r\n\r\n    setIsLoading(true);\r\n    setRoomType(roomSettings.type);\r\n    setPeer(p);\r\n\r\n    p.on(\"open\", (id) => {\r\n      history.push(`room/${id}`, roomSettings.controls);\r\n    });\r\n  }\r\n\r\n  return isLoading ? (\r\n    <Loading />\r\n  ) : (\r\n    <Form title=\"Opções da Sala\" onSubmit={create} submitText=\"Criar\">\r\n      <div className=\"input-field col s12\">\r\n        <p>Tipo de sala:</p>\r\n        <RadioList\r\n          name=\"roomType\"\r\n          list={typeList}\r\n          value={roomSettings.type}\r\n          updateValue={updateType}\r\n        />\r\n      </div>\r\n\r\n      <div className=\"input-field col s12\">\r\n        <p>Controles dos participantes:</p>\r\n        <CheckboxList\r\n          list={controlsList}\r\n          values={roomSettings.controls}\r\n          updateValues={updateControls}\r\n        />\r\n      </div>\r\n\r\n      <div className=\"input-field col s12\">\r\n        <label htmlFor=\"roomId\">\r\n          ID da sala (deixe em branco parar gerar um ID aleatório):\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"roomId\"\r\n          value={roomId}\r\n          onChange={(e) => setRoomId(e.target.value)}\r\n          placeholder=\"ID da sala\"\r\n        />\r\n      </div>\r\n    </Form>\r\n  );\r\n}\r\n\r\nexport default CreateRoom;\r\n","import React from \"react\";\r\nimport { useHistory } from \"react-router\";\r\nimport Form from \"../../components/Form\";\r\n\r\nfunction JoinRoom() {\r\n  const history = useHistory();\r\n\r\n  function join() {\r\n    const roomId = document.getElementById(\"room-id\").value;\r\n    history.push(`room/${roomId}`);\r\n  }\r\n\r\n  return (\r\n    <Form title=\"Entrar na Sala\" onSubmit={join} submitText=\"Entrar\">\r\n      <div className=\"input-field col s12\">\r\n        <input placeholder=\"Cole aqui o ID da sala\" id=\"room-id\" type=\"text\" />\r\n      </div>\r\n    </Form>\r\n  );\r\n}\r\n\r\nexport default JoinRoom;\r\n","import React, { useState } from \"react\";\r\n\r\nexport const SettingsContext = React.createContext();\r\n\r\nexport function SettingsProvider({ children }) {\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const [micOpen, setMicOpen] = useState(true);\r\n  const [camOpen, setCamOpen] = useState(true);\r\n\r\n  function handleOpen() {\r\n    setIsVisible(true);\r\n  }\r\n\r\n  return (\r\n    <SettingsContext.Provider\r\n      value={{\r\n        isVisible,\r\n        setIsVisible,\r\n        handleOpen,\r\n        micOpen,\r\n        setMicOpen,\r\n        camOpen,\r\n        setCamOpen,\r\n      }}\r\n    >\r\n      {children}\r\n    </SettingsContext.Provider>\r\n  );\r\n}\r\n","import { useEffect, useRef } from 'react'\r\nimport './Video.css'\r\n\r\nexport default function Video({ ref, srcObject, ...props }) {\r\n  const refVideo = useRef(null)\r\n\r\n  useEffect(() => {\r\n    if (!refVideo.current) return\r\n    refVideo.current.srcObject = srcObject\r\n  }, [srcObject])\r\n\r\n  return <video ref={refVideo} {...props} />\r\n}","import React, { useEffect } from \"react\";\r\nimport Video from \".\";\r\n\r\nfunction VideoList({ list }) {\r\n  let cols = 1,\r\n    rows = 1;\r\n\r\n  if (list.length >= 10) {\r\n    cols = 5;\r\n    rows = Math.floor(list.length / 5);\r\n  } else if (list.length > 2) {\r\n    cols = Math.ceil(list.length / 2);\r\n    rows = 2;\r\n  } else {\r\n    cols = list.length;\r\n    rows = 1;\r\n  }\r\n\r\n  const container = document.querySelector(\".App\");\r\n  // The gap between videos is 0.5rem = 8px (4px each side)\r\n  const width = container.clientWidth / cols - 4;\r\n  const height = container.clientHeight / rows - 4;\r\n\r\n  useEffect(() => {\r\n    const videoList = document.querySelector(\".Video-List\");\r\n    videoList.style.setProperty(\"--cols\", cols);\r\n    videoList.style.setProperty(\"--rows\", rows);\r\n  }, [cols]);\r\n\r\n  const videos = list.map((call, i) => {\r\n    return (\r\n      <div className=\"Video-List-item\" key={i} style={{ width, height }}>\r\n        <Video srcObject={call.stream} autoPlay />\r\n      </div>\r\n    );\r\n  });\r\n\r\n  return <section className=\"Video-List\">{videos}</section>;\r\n}\r\n\r\nexport default VideoList;\r\n","import React, { useContext, useEffect, useRef } from \"react\";\r\nimport { RoomContext } from \"../../../context/RoomContext\";\r\nimport VideoList from \"../../../components/Video/VideoList\";\r\n\r\nfunction Owner({ roomControls, children }) {\r\n  const { peer, roomType, localStream, calls, setCalls } =\r\n    useContext(RoomContext);\r\n\r\n  const localStreamRef = useRef();\r\n  localStreamRef.current = localStream;\r\n\r\n  const callsRef = useRef();\r\n  callsRef.current = calls;\r\n\r\n  useEffect(() => {\r\n    peer.on(\"connection\", (conn) => {\r\n      conn.on(\"open\", () => {\r\n        conn.send({ roomType, roomControls });\r\n      });\r\n      newConnection(conn);\r\n    });\r\n  }, []);\r\n\r\n  function newConnection(conn) {\r\n    let _call = peer.call(conn.peer, localStreamRef.current);\r\n\r\n    _call.on(\"stream\", (remote) => {\r\n      // This check is needed because this event fires twice\r\n      // One time for each stream track, i.e., audio and video\r\n      const isPresent = callsRef.current.some((call) => {\r\n        return call.peer === _call.peer;\r\n      });\r\n\r\n      if (!isPresent) {\r\n        _call.stream = remote;\r\n        setCalls([...callsRef.current, _call]);\r\n      }\r\n    });\r\n\r\n    // must do this because call.on('close') doesn't fire\r\n    conn.on(\"close\", () => endConnection(conn));\r\n\r\n    // This is in case the connection ends abruptly\r\n    conn.peerConnection.oniceconnectionstatechange = () => {\r\n      if (conn.peerConnection.iceConnectionState === \"disconnected\") {\r\n        endConnection(conn);\r\n      }\r\n    };\r\n  }\r\n\r\n  function endConnection(conn) {\r\n    const newCalls = callsRef.current.filter((call) => {\r\n      return call.peer !== conn.peer;\r\n    });\r\n    setCalls(newCalls);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {calls.length > 0 ? (\r\n        <VideoList list={calls} />\r\n      ) : (\r\n        <p>Aguardando conexão...</p>\r\n      )}\r\n      {children}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Owner;\r\n","import React, { useContext, useEffect, useState } from \"react\";\r\nimport { RoomContext } from \"../../context/RoomContext\";\r\nimport { SettingsContext } from \"../../context/SettingsContext\";\r\nimport utils from \"../../utils\";\r\nimport \"./Settings.css\";\r\n\r\nfunction Settings({ children, mic, cam }) {\r\n  const { isVisible, setIsVisible, micOpen, camOpen } =\r\n    useContext(SettingsContext);\r\n  const { calls, localStream, setLocalStream } = useContext(RoomContext);\r\n  const [devices, setDevices] = useState([]);\r\n  const [mirrorCam, setMirrorCam] = useState(false);\r\n\r\n  useEffect(() => {\r\n    navigator.mediaDevices.enumerateDevices().then((devices) => {\r\n      setDevices(devices);\r\n    });\r\n  }, []);\r\n\r\n  function handleChange(e) {\r\n    if (e.target.id === \"audio-inputs\") {\r\n      const constraints = {\r\n        video: {\r\n          deviceId: localStream.getVideoTracks()[0].getSettings().deviceId,\r\n        },\r\n        audio: { deviceId: e.target.value },\r\n      };\r\n\r\n      navigator.mediaDevices.getUserMedia(constraints).then((stream) => {\r\n        utils.replaceAudio(stream, localStream, calls[0]);\r\n        stream.getAudioTracks()[0].enabled = micOpen;\r\n        setLocalStream(stream);\r\n      });\r\n    } else if (e.target.id === \"video-inputs\") {\r\n      const constraints = {\r\n        video: { deviceId: e.target.value },\r\n        audio: {\r\n          deviceId: localStream.getAudioTracks()[0].getSettings().deviceId,\r\n        },\r\n      };\r\n\r\n      navigator.mediaDevices.getUserMedia(constraints).then((stream) => {\r\n        utils.replaceVideo(stream, localStream, calls[0]);\r\n        stream.getVideoTracks()[0].enabled = camOpen;\r\n        setLocalStream(stream);\r\n      });\r\n    }\r\n  }\r\n\r\n  function handleMirror() {\r\n    const video = document.querySelector(\".local-vid\");\r\n    if (mirrorCam) {\r\n      video.style.transform = video.style.transform.replace(\"scaleX(-1)\", \"\");\r\n    } else {\r\n      video.style.transform += \"scaleX(-1)\";\r\n    }\r\n    setMirrorCam(!mirrorCam);\r\n  }\r\n\r\n  function handleClose() {\r\n    setIsVisible(false);\r\n  }\r\n\r\n  return (\r\n    <section className={`Settings ${isVisible ? \"show\" : \"\"}`}>\r\n      {children}\r\n      <div className=\"row\">\r\n        {mic && (\r\n          <div className=\"input-field col s12\">\r\n            <label htmlFor=\"audio-inputs\">Entrada de áudio (microfone):</label>\r\n            <select\r\n              id=\"audio-inputs\"\r\n              className=\"browser-default\"\r\n              onChange={handleChange}\r\n            >\r\n              {devices\r\n                .filter((device) => device.kind === \"audioinput\")\r\n                .map((device, i) => (\r\n                  <option value={device.deviceId} key={i}>\r\n                    {device.label}\r\n                  </option>\r\n                ))}\r\n            </select>\r\n          </div>\r\n        )}\r\n\r\n        {cam && (\r\n          <>\r\n            <div className=\"input-field col s12\">\r\n              <label htmlFor=\"video-inputs\">Entrada de vídeo (câmera):</label>\r\n              <select\r\n                id=\"video-inputs\"\r\n                className=\"browser-default\"\r\n                onChange={handleChange}\r\n              >\r\n                {devices\r\n                  .filter((device) => device.kind === \"videoinput\")\r\n                  .map((device, i) => (\r\n                    <option value={device.deviceId} key={i}>\r\n                      {device.label}\r\n                    </option>\r\n                  ))}\r\n              </select>\r\n            </div>\r\n\r\n            <div className=\"input-field col s12\">\r\n              <label>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  className=\"filled-in\"\r\n                  checked={mirrorCam}\r\n                  onChange={handleMirror}\r\n                />\r\n                <span>Espelhar vídeo</span>\r\n              </label>\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n\r\n      <button\r\n        className=\"btn waves-effect waves-light blue\"\r\n        onClick={handleClose}\r\n      >\r\n        OK\r\n      </button>\r\n    </section>\r\n  );\r\n}\r\n\r\nexport default Settings;\r\n","import React, { useContext } from \"react\";\r\nimport { RoomContext } from \"../../context/RoomContext\";\r\nimport { SettingsContext } from \"../../context/SettingsContext\";\r\nimport utils from \"../../utils\";\r\nimport \"./Toolbar.css\";\r\n\r\nfunction Toolbar({ mic, cam, screen }) {\r\n  const {\r\n    calls,\r\n    screenStream,\r\n    handleMic,\r\n    handleCam,\r\n    handleScreenShare,\r\n    handleCallEnd,\r\n  } = useContext(RoomContext);\r\n\r\n  const { handleOpen, micOpen, setMicOpen, camOpen, setCamOpen } =\r\n    useContext(SettingsContext);\r\n\r\n  function toggleMic() {\r\n    handleMic();\r\n    setMicOpen(!micOpen);\r\n  }\r\n\r\n  function toggleCam() {\r\n    handleCam();\r\n    setCamOpen(!camOpen);\r\n  }\r\n\r\n  return (\r\n    <div className=\"Toolbar\">\r\n      {mic && (\r\n        <button\r\n          className=\"btn-floating btn-large waves-effect waves-light blue\"\r\n          onClick={toggleMic}\r\n        >\r\n          <i className=\"material-icons\">{micOpen ? \"mic\" : \"mic_off\"}</i>\r\n        </button>\r\n      )}\r\n\r\n      {cam && (\r\n        <button\r\n          className=\"btn-floating btn-large waves-effect waves-light blue\"\r\n          onClick={toggleCam}\r\n        >\r\n          <i className=\"material-icons\">\r\n            {camOpen ? \"videocam\" : \"videocam_off\"}\r\n          </i>\r\n        </button>\r\n      )}\r\n\r\n      {screen && calls?.length > 0 && !utils.isMobile() && (\r\n        <button\r\n          className=\"btn-floating btn-large waves-effect waves-light blue\"\r\n          onClick={handleScreenShare}\r\n        >\r\n          <i className=\"material-icons\">\r\n            {screenStream ? \"stop_screen_share\" : \"screen_share\"}\r\n          </i>\r\n        </button>\r\n      )}\r\n\r\n      {(mic || cam) && (\r\n        <button\r\n          className=\"btn-floating btn-large waves-effect waves-light grey darken-2\"\r\n          onClick={handleOpen}\r\n        >\r\n          <i className=\"material-icons\">settings</i>\r\n        </button>\r\n      )}\r\n\r\n      <button\r\n        className=\"btn-floating btn-large waves-effect waves-light red\"\r\n        onClick={handleCallEnd}\r\n      >\r\n        <i className=\"material-icons\">call_end</i>\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Toolbar;\r\n","import React, { useContext, useEffect, useRef, useState } from \"react\";\r\nimport { useParams } from \"react-router\";\r\nimport { RoomContext } from \"../../../context/RoomContext\";\r\nimport { SettingsProvider } from \"../../../context/SettingsContext\";\r\nimport Video from \"../../../components/Video\";\r\nimport Settings from \"../../../components/Settings\";\r\nimport Toolbar from \"../../../components/Toolbar\";\r\n\r\nfunction Participant({ controls, setControls }) {\r\n  const {\r\n    peer,\r\n    roomType,\r\n    setRoomType,\r\n    localStream,\r\n    calls,\r\n    setCalls,\r\n    msg,\r\n    setMsg,\r\n  } = useContext(RoomContext);\r\n  const { id: roomId } = useParams();\r\n  const msgRef = useRef();\r\n  msgRef.current = msg;\r\n\r\n  useEffect(() => {\r\n    const conn = peer.connect(roomId);\r\n    setMsg(\"Tentando conectar...\");\r\n\r\n    conn.on(\"open\", () => {\r\n      conn.on(\"data\", (data) => {\r\n        setRoomType(data.roomType);\r\n        setControls(data.roomControls);\r\n      });\r\n    });\r\n\r\n    peer.on(\"call\", (call) => {\r\n      setMsg(\"Conexão estabelecida\");\r\n      call.answer(localStream);\r\n      call.on(\"stream\", (remote) => {\r\n        call.stream = remote;\r\n        setCalls([call]);\r\n\r\n        if (!controls.mic) {\r\n          call.peerConnection.getSenders()[0].track.enabled = false;\r\n        }\r\n      });\r\n    });\r\n\r\n    // must do this because call.on('close') doesn't fire\r\n    conn.on(\"close\", () => {\r\n      setMsg(\"O anfitrião saiu da sala\");\r\n      setCalls([]);\r\n    });\r\n\r\n    conn.peerConnection.oniceconnectionstatechange = () => {\r\n      if (conn.peerConnection.iceConnectionState === \"disconnected\") {\r\n        setMsg(\"O anfitrião saiu da sala\");\r\n        setCalls([]);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <>\r\n      {calls.length > 0 ? (\r\n        <Video srcObject={calls[0].stream} autoPlay />\r\n      ) : (\r\n        <p>{msgRef.current}</p>\r\n      )}\r\n\r\n      <SettingsProvider>\r\n        <Toolbar\r\n          mic={controls.mic}\r\n          cam={controls.cam}\r\n          screen={controls.screen}\r\n        />\r\n        <Settings mic={controls.mic} cam={controls.cam} />\r\n      </SettingsProvider>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Participant;\r\n","import React from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\n\r\nfunction CopyLink() {\r\n  const { id: roomId } = useParams();\r\n\r\n  function handleCopy() {\r\n    const copyText = document.getElementById(\"room-id\");\r\n    copyText.select();\r\n    copyText.setSelectionRange(0, 99999); /* For mobile devices */\r\n    document.execCommand(\"copy\");\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <div className=\"row\">\r\n        <div className=\"col s12 m3\">\r\n          <p>Link da sala:</p>\r\n        </div>\r\n        <div className=\"col s9 m6\">\r\n          <input\r\n            type=\"text\"\r\n            readOnly\r\n            id=\"room-id\"\r\n            value={`${window.location.origin}/room/${roomId}`}\r\n          />\r\n        </div>\r\n        <div className=\"col s3\">\r\n          <button className=\"blue waves-effect btn\" onClick={handleCopy}>\r\n            Copiar Link\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default CopyLink;\r\n","import Peer from \"peerjs\";\r\nimport React, { useContext, useEffect, useState } from \"react\";\r\nimport { useLocation, useParams } from \"react-router-dom\";\r\nimport { RoomContext } from \"../../context/RoomContext\";\r\nimport { SettingsProvider } from \"../../context/SettingsContext\";\r\nimport Owner from \"./Owner\";\r\nimport Participant from \"./Participant\";\r\nimport Toolbar from \"../../components/Toolbar/\";\r\nimport Settings from \"../../components/Settings\";\r\nimport CopyLink from \"../../components/CopyLink\";\r\nimport Video from \"../../components/Video\";\r\nimport utils from \"../../utils\";\r\n\r\nfunction Room() {\r\n  const { peer, setPeer, localStream, setLocalStream, screenStream, setMsg } =\r\n    useContext(RoomContext);\r\n  const { id: roomId } = useParams();\r\n  const location = useLocation();\r\n  const [isPeerOpen, setIsPeerOpen] = useState(false);\r\n  const [roomControls, setRoomControls] = useState({\r\n    mic: false,\r\n    cam: false,\r\n    screen: false,\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (location.state) {\r\n      setRoomControls(location.state);\r\n    }\r\n\r\n    if (peer === null) {\r\n      const p = new Peer({ debug: 3 });\r\n      p.on(\"open\", () => {\r\n        setIsPeerOpen(true);\r\n        p.on(\"error\", (err) => {\r\n          setMsg(\"Desculpe, houve um erro\");\r\n          console.log(err);\r\n        });\r\n      });\r\n      setPeer(p);\r\n    } else if (!!peer.id) {\r\n      setIsPeerOpen(true);\r\n    }\r\n\r\n    utils.getUserMedia().then((stream) => {\r\n      setLocalStream(stream);\r\n    });\r\n  }, []);\r\n\r\n  return (\r\n    <>\r\n      {isPeerOpen && localStream && (\r\n        <>\r\n          {peer?.id === roomId ? (\r\n            <Owner roomControls={roomControls}>\r\n              <SettingsProvider>\r\n                <Toolbar mic cam screen />\r\n                <Settings mic cam>\r\n                  <CopyLink />\r\n                </Settings>\r\n              </SettingsProvider>\r\n            </Owner>\r\n          ) : (\r\n            <Participant\r\n              controls={roomControls}\r\n              setControls={setRoomControls}\r\n            />\r\n          )}\r\n        </>\r\n      )}\r\n\r\n      {screenStream ? (\r\n        <Video className=\"local-vid\" srcObject={screenStream} autoPlay muted />\r\n      ) : (\r\n        <Video className=\"local-vid\" srcObject={localStream} autoPlay muted />\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Room;\r\n","import React from \"react\";\r\n\r\nfunction CallEnded() {\r\n  return <div>Você saiu da sala.</div>;\r\n}\r\n\r\nexport default CallEnded;\r\n","import { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\r\nimport \"./App.css\";\r\nimport Home from \"./pages/Home/\";\r\nimport CreateRoom from \"./pages/CreateRoom\";\r\nimport JoinRoom from \"./pages/JoinRoom\";\r\nimport Room from \"./pages/Room\";\r\nimport { CreateRoomProvider } from \"./context/CreateRoomContext\";\r\nimport { RoomProvider } from \"./context/RoomContext\";\r\nimport CallEnded from \"./pages/CallEnded\";\r\n\r\nfunction App() {\r\n  return (\r\n    <div className=\"App container\">\r\n      <Router basename={process.env.PUBLIC_URL}>\r\n        <RoomProvider>\r\n          <Switch>\r\n            <Route path=\"/create\">\r\n              <CreateRoomProvider>\r\n                <CreateRoom />\r\n              </CreateRoomProvider>\r\n            </Route>\r\n\r\n            <Route path=\"/join\">\r\n              <JoinRoom />\r\n            </Route>\r\n\r\n            <Route path=\"/room/:id\">\r\n              <Room />\r\n            </Route>\r\n\r\n            <Route path=\"/call-end\">\r\n              <CallEnded />\r\n            </Route>\r\n\r\n            <Route path=\"/\">\r\n              <Home />\r\n            </Route>\r\n          </Switch>\r\n        </RoomProvider>\r\n      </Router>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n"],"sourceRoot":""}